function contains(s,a){for(var n in s)if(s[n].albumname==a)return n;return-1}var app=angular.module("top5app",["ui.sortable","firebase"]);app.controller("AppControl",["$scope","$firebase",function(s,a){var n=new Firebase("https://top52014test.firebaseIO.com/"),e=a(n.child("years").child("2014"));s.albumList=e.$asArray(),s.submissions=[{bandname:"1st",albumname:"1"},{bandname:"2nd",albumname:"2"},{bandname:"3rd",albumname:"3"}],s.addAlbum=function(){s.submissions.length<10&&contains(s.submissions,s.albumname)<0&&s.submissions.push({bandname:s.bandname,albumname:s.albumname}),s.bandname="",s.albumname=""},s.deleteItem=function(a){s.submissions.splice(a,1)},s.submitAlbums=function(){for(var a in s.submissions){var n=s.submissions[a],e=10-a,m=contains(s.albumList,n.albumname);0>m?s.albumList.$add({albumname:n.albumname,bandname:n.bandname,score:e,votes:[{user:s.userName,points:e}]}):(console.log("i: "+a),console.log("index: "+m),console.log(s.albumList[m]),s.albumList[m].score+=e,s.albumList[m].votes.push({user:s.userName,points:e}),s.albumList.$save(s.albumList[m]))}s.submissions=[]}}]);